"use strict";(self.webpackChunkgns_3_docs=self.webpackChunkgns_3_docs||[]).push([[4052],{5680:(e,t,n)=>{n.d(t,{xA:()=>u,yg:()=>g});var o=n(6540);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=o.createContext({}),c=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=c(e.components);return o.createElement(l.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},h=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=c(n),h=a,g=p["".concat(l,".").concat(h)]||p[h]||d[h]||r;return n?o.createElement(g,i(i({ref:t},u),{},{components:n})):o.createElement(g,i({ref:t},u))}));function g(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[p]="string"==typeof e?e:a,i[1]=s;for(var c=2;c<r;c++)i[c]=n[c];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}h.displayName="MDXCreateElement"},8423:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>c,default:()=>g,frontMatter:()=>l,metadata:()=>u,toc:()=>d});var o=n(8168),a=n(8587),r=(n(6540),n(5680)),i=n(6025),s=["components"],l={id:"docker-support-in-gns3",title:"Docker support in GNS3",sidebar_label:"Docker support in GNS3"},c=void 0,u={unversionedId:"emulators/docker-support-in-gns3",id:"emulators/docker-support-in-gns3",title:"Docker support in GNS3",description:"Docker container support was added as a feature starting with GNS3 1.5. Work on this feature was started by Goran Cetusic during the Google Summer Of Code and finished by the GNS3 core team.",source:"@site/docs/emulators/docker-support-in-gns3.md",sourceDirName:"emulators",slug:"/emulators/docker-support-in-gns3",permalink:"/docs/emulators/docker-support-in-gns3",draft:!1,editUrl:"https://github.com/mother/gns3-docs/blob/master/docs/emulators/docker-support-in-gns3.md",tags:[],version:"current",frontMatter:{id:"docker-support-in-gns3",title:"Docker support in GNS3",sidebar_label:"Docker support in GNS3"},sidebar:"someSidebar",previous:{title:"Adding VMware VMs to GNS3 Topologies",permalink:"/docs/emulators/adding-vmware-vms-to-gns3-topologies"},next:{title:"Create a docker container for GNS3",permalink:"/docs/emulators/create-a-docker-container-for-gns3"}},p={},d=[{value:"Advantages of Containers versus QEMU VMS",id:"advantages-of-containers-versus-qemu-vms",level:2},{value:"Warning",id:"warning",level:3},{value:"Adding a container template",id:"adding-a-container-template",level:2},{value:"Persistence",id:"persistence",level:2},{value:"Networking",id:"networking",level:2},{value:"VNC",id:"vnc",level:2},{value:"HTTP",id:"http",level:2},{value:"Auxiliary Console",id:"auxiliary-console",level:2},{value:"Images designed for running inside GNS3",id:"images-designed-for-running-inside-gns3",level:2}],h={toc:d};function g(e){var t=e.components,n=(0,a.A)(e,s);return(0,r.yg)("wrapper",(0,o.A)({},h,n,{components:t,mdxType:"MDXLayout"}),(0,r.yg)("p",null,"Docker container support was added as a feature starting with GNS3 1.5. Work on this feature was started by Goran Cetusic during the Google Summer Of Code and finished by the GNS3 core team."),(0,r.yg)("p",null,"Bernhard Ehlers and AJ Nouri contributed a lot of their time to the testing/validation of this feature, and Andras Dosztal has added many containers as appliances available in the Marketplace (like the Network Automation container, for example)."),(0,r.yg)("h2",{id:"advantages-of-containers-versus-qemu-vms"},"Advantages of Containers versus QEMU VMS"),(0,r.yg)("p",null,"Containers use services provided by the kernel in the host OS (meaning the GNS3 VM or the local machine, if running GNS3 natively in Linux), and not relying on the kernel provided by the OS installed within a Qemu VM.  This means containers consume far less RAM and CPU resources overall, per instance, and have a smaller storage footprint. Docker containers are available from a registry, so you can fork them in order to add your own tools."),(0,r.yg)("h3",{id:"warning"},"Warning"),(0,r.yg)("p",null,"The idea isn\u2019t to simulate the deployment of container infrastructure in production, but to use containers as light virtual machines, replacing heavy qemu VMs instances or VPCS, for times  when you want to use tools like telnet, nmap, etc\u2026"),(0,r.yg)("p",null,"Only the top-most layer in a docker container is actually read/write. All of the layers beneath it are read-only."),(0,r.yg)("p",null,"It\u2019s also not designed to control a docker cluster for production or development.  If you want to simulate real life container infrastructure, you need to deploy an OS in a Qemu VM, and start the  containers in it."),(0,r.yg)("h2",{id:"adding-a-container-template"},"Adding a container template"),(0,r.yg)("p",null,"Go to Edit->Preferences->Docker containers and click on New:"),(0,r.yg)("img",{alt:"screenshot",src:(0,i.A)("img/emulators/docker-support-in-gns3/1.jpg")}),(0,r.yg)("p",null,"Next, select the server you wish to run the container with. Since this article is being written on a Win 10 Pro desktop that has the GNS3 VM running in WS Pro 15.5, that\u2019s the only available option:"),(0,r.yg)("img",{alt:"screenshot",src:(0,i.A)("img/emulators/docker-support-in-gns3/2.jpg")}),(0,r.yg)("p",null,"(Running GNS3 natively in Linux would allow this container to run via the local server, or if GNS3 had been configured to use a remote server, that option would be available, too)"),(0,r.yg)("p",null,"You will need to select the container you wish to use.  There are many freely available  containers over on  Docker Hub (",(0,r.yg)("a",{parentName:"p",href:"https://hub.docker.com"},"https://hub.docker.com"),"), as well as in the GNS3 Marketplace (you\u2019d simply use download the relevant .gns3a appliance file, use the \u201cimport appliance\u201d wizard, and follow the direction).  "),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Please note")," that most containers start a daemon and expose ports. This will not work on GNS3 because we need to configure the IP address inside the container (in standard usage, docker take care of the networking and you can not access containers directly from the network)"),(0,r.yg)("p",null,"We will use for this example an image of Alpine Linux 3.2, which is a very lightweight Linux distribution."),(0,r.yg)("p",null,"You can see all the alpine linux versions available for Docker here:\n",(0,r.yg)("a",{parentName:"p",href:"https://hub.docker.com/_/alpine/"},"https://hub.docker.com/_/alpine/"),"*"),(0,r.yg)("img",{alt:"screenshot",src:(0,i.A)("img/emulators/docker-support-in-gns3/3.jpg")}),(0,r.yg)("p",null,"On the next screen, we\u2019ll elect to use the alpine docker container from Docker Hub.  Select ",(0,r.yg)("strong",{parentName:"p"},"\u201cNew Image\u201d"),", and in the dialog box, type ",(0,r.yg)("inlineCode",{parentName:"p"},"alpine:latest"),", as shown below, and then click ",(0,r.yg)("strong",{parentName:"p"},"Next >"),":  "),(0,r.yg)("img",{alt:"screenshot",src:(0,i.A)("img/emulators/docker-support-in-gns3/4.jpg")}),(0,r.yg)("p",null,"The reason to use \u201clatest\u201d, as opposed to using a specific version number, is so you can easily upgrade this container to the latest version on Docker Hub. You\u2019d enter the GNS3 VM\u2019s shell (or just use a terminal in Linux), and run \u201cdocker pull alpine:latest\u201d, and any changes will be pulled down from Docker Hub, and applied the existing container."),(0,r.yg)("p",null,"On the next screen, give the container a name. In this instance, it\u2019ll just be called \u201calpine\u201d, and that\u2019s what it will be listed as in the End Devices toolbar:"),(0,r.yg)("img",{alt:"screenshot",src:(0,i.A)("img/emulators/docker-support-in-gns3/5.jpg")}),(0,r.yg)("p",null,"Next, you\u2019ll assign how many adapters this container should have. Since This example will just be using the Alpine container as a host, it\u2019ll be left at the default of 1:"),(0,r.yg)("img",{alt:"screenshot",src:(0,i.A)("img/emulators/docker-support-in-gns3/6.jpg")}),(0,r.yg)("p",null,"(it\u2019s entirely possible to create a docker container based off of Debian with FRRouting installed, and have it run OSPF, BGP, or IS-IS, and act as a temporary light router. You could also have a container running an open-source firewall. Those are just two simple examples of why you\u2019d use more than a single interface for a container )"),(0,r.yg)("p",null,"Next, specify the start command. It\u2019s like the init process on a standard Linux. Often in GNS3, we just want a shell:"),(0,r.yg)("img",{alt:"screenshot",src:(0,i.A)("img/emulators/docker-support-in-gns3/7.jpg")}),(0,r.yg)("p",null,"On the next screen you\u2019ll choose a Console type from a dropdown menu. It\u2019s set to \u201cTelnet\u201d by default, which is fine for this example, so just click Next>:"),(0,r.yg)("img",{alt:"screenshot",src:(0,i.A)("img/emulators/docker-support-in-gns3/8.jpg")}),(0,r.yg)("p",null,"(the full list of console types are currently telnet, vnc, http, https, and none)"),(0,r.yg)("p",null,"Next, you can configure environment variables that will be accessible inside the container. A lot of Docker containers will use that for their configuration. We\u2019ll just use a simple \u201cHELLO=WORLD\u201d variable for this example:"),(0,r.yg)("img",{alt:"screenshot",src:(0,i.A)("img/emulators/docker-support-in-gns3/9.jpg")}),(0,r.yg)("p",null,"Click ",(0,r.yg)("strong",{parentName:"p"},"Finish")," to complete this wizard, and then click ",(0,r.yg)("strong",{parentName:"p"},"OK")," to exit out of the Preferences menu:"),(0,r.yg)("img",{alt:"screenshot",src:(0,i.A)("img/emulators/docker-support-in-gns3/10.jpg")}),(0,r.yg)("p",null,"At the end of the wizard, if the base container is not available already on your system, you will need to initiate a docker-pull. There are two methods of doing this. We\u2019ll look at the simplest method first."),(0,r.yg)("p",null,"(note: this docker pull only needs to occur once per-container, unless you deleted the container, deleted and reimported the GNS3 VM, or if you\u2019re attempting to upgrade the container, etc...)"),(0,r.yg)("p",null,"As stated previously, this container is found in the End Devices toolbar:"),(0,r.yg)("img",{alt:"screenshot",src:(0,i.A)("img/emulators/docker-support-in-gns3/11.jpg")}),(0,r.yg)("p",null,"Drag and drop an instance of the container into the topology (internet access is required at this point), and GNS3 will initiate the docker pull. You\u2019ll see the progress in the GNS3 Console pane:"),(0,r.yg)("img",{alt:"screenshot",src:(0,i.A)("img/emulators/docker-support-in-gns3/12.jpg")}),(0,r.yg)("p",null,"The second option is almost as easy, but it does require that you enter the GNS3 VM\u2019s shell (or use a terminal, if running GNS3 in Linux). You manually initiate the docker pull by using the command ",(0,r.yg)("inlineCode",{parentName:"p"},"docker pull  <name>:<version>"),". In this instance, it\u2019s ",(0,r.yg)("inlineCode",{parentName:"p"},"docker pull alpine:latest"),", as shown below:"),(0,r.yg)("img",{alt:"screenshot",src:(0,i.A)("img/emulators/docker-support-in-gns3/13.jpg")}),(0,r.yg)("p",null,"(This screenshot was taken after having initiating the docker pull via the GNS3 GUI, so the docker engine is just letting us know that we have the latest version. Had there been an updated version published (or if the pull hadn\u2019t been run in the GUI already), you\u2019d see the same progress as shown in the GNS3 console)"),(0,r.yg)("p",null,"Next, you can start the container in the topology, and open a console window. The \u201cenv\u201d command was to show the environmental variables:"),(0,r.yg)("img",{alt:"screenshot",src:(0,i.A)("img/emulators/docker-support-in-gns3/14.jpg")}),(0,r.yg)("p",null,"Please note that network interfaces will be available only when a cable is connected!"),(0,r.yg)("h2",{id:"persistence"},"Persistence"),(0,r.yg)("p",null,"By default, changes made to the read/write layer of the container are not written to disk, thus not persistent across reboots.   The container needs to be designed in advance for this behavior to be changed."),(0,r.yg)("p",null,"If, in the Dockerfile, the container mounts volumes, GNS3 will create in a folder (within the overall Project Folder for this project) for each of the Docker volumes, and will write files inside those."),(0,r.yg)("p",null,"This means if you use a container outside GNS3,  that data will not be available. But, this also means that all the data of the current GNS3 project is stored in the same location."),(0,r.yg)("h2",{id:"networking"},"Networking"),(0,r.yg)("p",null,"When you use a normal Docker installation, the networking part is managed for you. Because GNS3 uses docker to simulate a computer, you need to configure it by hand."),(0,r.yg)("p",null,"The file \u201c/etc/network/interfaces\u201d is read at container start and you can edit it from within the container, or you can also graphically edit that file in the GNS3 GUI, by right-clicking on a stopped instance of the container in a topology, selecting \u201cEdit Config\u201d, edit the ",(0,r.yg)("inlineCode",{parentName:"p"},"/etc/network/interfaces"),"  file in the resulting pop up window, selecting \u201cSave\u201d, and then starting the container."),(0,r.yg)("p",null,"This file contains a sample config that you can tune to adapt the config to suit your simulated network within the topology (like assigning it a static IP, or setting it to use DHCP). The directory ",(0,r.yg)("inlineCode",{parentName:"p"},"/etc/network")," is persisted on disk on a per-project basis."),(0,r.yg)("h2",{id:"vnc"},"VNC"),(0,r.yg)("p",null,"You can launch graphical programs if you choose VNC as the console type. Behind the scenes,  GNS3 will start a fake Xserver (using Xvfb) and inject it in the container. After that this X server is exposed to the network via X11VNC. You don\u2019t need to modify your container to get VNC support. A limitation of this, is that any container can access the X socket of other containers."),(0,r.yg)("h2",{id:"http"},"HTTP"),(0,r.yg)("p",null,"You can replace the telnet console with a web page, if your container is running a web server. This support will not work for some applications, because we just forward the data without interpreting the data being passed by HTTP."),(0,r.yg)("h2",{id:"auxiliary-console"},"Auxiliary Console"),(0,r.yg)("p",null,"By default, we start a /bin/sh as an auxiliary console. This allows you to get a shell for a container, where the start command is not a shel,l or if the console type is VNC.  Under the hood, it\u2019s a docker exec starting a custom busybox shell. For technical reasons, this is slower than the standard telnet console."),(0,r.yg)("h2",{id:"images-designed-for-running-inside-gns3"},"Images designed for running inside GNS3"),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"https://hub.docker.com/u/gns3/"},"https://hub.docker.com/u/gns3/")))}g.isMDXComponent=!0}}]);